{%extends 'base.html.twig' %}

{% block body %}
    <article>

        <h2>{{ book.title | escape }}</h2>
        <span class="badge badge-pill badge-dark">{{ book.category }}</span>
        <div class="metadata">écrit le {{ book.date | date('d/m/Y') }} à {{ book.date | date('H:i') }}
        par {{ book.author | escape }}</div>
        {% if app.user %}
            {% if app.user.username is same as(book.author) %}
                
                <a class="btn btn-outline-secondary" href="{{ path('edit_book', {'id': book.id }) }}" role="button">Modifier le livre</a>
                
                {#<!-- Button trigger modal -->#}
                <button type="button" class="btn btn-dark" data-toggle="modal" data-target="#exampleModal">
                Supprimer ce livre
                </button>

                {#<!-- Modal -->#}
                <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Suppression</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        Voulez-vous vraiment supprimer ce livre ? <br>
                        <span class="badge badge-pill badge-dark"> {{ book.title | escape }} </span>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Annuler</button>
                        <a class="btn btn-dark" href="{{ path('delete_book', {'id': book.id }) }}" role="button">Supprimer</a>
                    </div>
                    </div>
                </div>
                </div>
            {% endif %}
        {% endif %}
        
        <hr>
        <div>{{ book.content | escape }}</div>
    </article>
    <hr>
    <section id="chapters">
        <h3>{{ book.chapters | length }} Chapitres :</h3>
        {% if app.user %}
            {% if app.user.username is same as(book.author) %}
            <a class="btn btn-outline-secondary" href="{{ path('new_chapter', {'id': book.id }) }}" role="button">➕ Nouveau chapitre</a>
            {% endif %}
        {% endif %}
        <hr>
        <div>
        {% for chapter in chapters %}
            <p><a href="{{ path('chapter_show', {'id': chapter.id }) }}">{{ chapter.title }}</a></p>
        {% endfor %}
        </div>
    </section>
    
{% endblock %}